Когда мы переносим наш уже измененный файл в промежуточную область:### Перемещение изменений в файлах между областями

![[Pasted image 20250423091333.png]]

#### Этап I — Начальный

Мы находимся в рабочей директории ([[Working directory]]). Это может быть копия версии проекта, клонированная с удаленного репозитория, которая находится теперь у нас на жестком диске компьютера. Или это может быть созданный нами репозиторий. 

Суть в том, что это **рабочая директория/каталог.** Здесь мы будем производить все действия по редактированию файлов: переписывать код, менять шрифты, цвета, добавлять новые блоки и функции, удалять старые и т.д. В общем, меняем тут какие-то файлы, добавляем новые, какие-то удаляем — совершаем те действия/изменения, которые потом хотим сохранить в Git.

#### Этап II — Подготовка файлов

Отредактировали файлы и хотим сохранить эти изменения. Мы не можем напрямую положить их в базу Гита, сначала надо переместить изменения в промежуточную область — в [[Staging area]] (индекс) — так мы показываем гиту, что эти изменения важны и их надо сохранить: **Stage fixes**.

#### Этап III — Сохранение

Когда мы убедились, что изменения в **Индексе** хотим сохранить в Git — сделаем коммит: **Commit**

Как только мы сделали коммит, изменения в сжатом виде попадают в [[directory .git]] (**каталог Git**)** и надежно хранятся в папке **.git**.

#### Этап IV — Работа с версией

Мы храним изменения в Git для того, чтобы ими когда-нибудь воспользоваться. Поэтому есть команда [[git checkout]], которая позволяет вытащить изменения из **каталога Git** обратно в **рабочую директорию** (См: [[Файлы в Git]])

### Состояние файлов

_**1) неотслеживаемые**_ файлы (_**Untracked**_) — это все те файлы в **Working Directory**, о которых Гит ничего не знает. Эти файлы не входили в последний коммит и не подготовлены к коммиту.  

Когда мы создаем новый репозиторий, Гит ничего не хранит, никакие файлы в нем не отслеживает. То же самое с каждым новым файлом в репозитории — Гит не может сразу их автоматически подхватить, он просто скажет нам, что видит файлы, но не следит за ними (не хранит их). 

Для того, чтобы Гит их хранил, мы должны их проиндексировать — добавить в **Staging area** (Командой [[git add]] в [[Staging area]]).

#### Как Git определяет их так:
1. Ищет файлы в рабочей директории.
2. Исключает:
	а) Файлы из `.gitignore`
	б) Уже отслеживаемые файлы

_**2) отслеживаемые**_ файлы — это те файлы, о существовании которых гит знает — они находятся под версионным контролем.

Когда мы впервые клонируем репозиторий все файлы в нем будут отслеживаемыми и неизмененными, потому что Git только что их извлек, и мы ничего пока не редактировали.

#### Git проверяет на отслеживаемость сравнивая:
- Проверяет запись в **индексе** (`.git/index`, [[Строение GIT]]]).
- Сравнивает с историей **последнего коммита** ([[HEAD]]).

_**3) измененный**_ (_**Modified**_) — файлы, которые **уже отслеживаются**, но были изменены после последнего коммита.

#### Как Git определяет:
1. Сравнивает:
    - **Текущее состояние файла** (рабочая директория - [[Working directory]])
    - **Последнюю зафиксированную версию** ([[HEAD]])
2. Вычисляет хэш SHA-1 содержимого файла.

_**4) индексированный**_ — (**_Staged_**) — добавленный под версионный контроль Гита, помещенный в [[Staging area]]. 

В этом статусе файл готов к отправке в репозиторий (готов коммиту [[git commit]]). Такие файлы находятся уже на пути к фиксации изменений в них, но пока эти изменения не сохранены в базе Git. 

Файлы будут находиться здесь до тех пор, пока мы не сохраним их (не сделаем коммит).

#### Как Git определяет:

1. Проверяет записи в .git/index.
2. Сравнивает хэши:
	Версия в индексе ≠ версия в последнем коммите → staged
	Версия в индексе = версия в рабочей директории → готов к коммиту

_**5) зафиксированный**_ — (_**Сommitted**_) — сохраненный в локальном хранилище, закоммиченный файл, готовый к отправке в удаленный репозиторий. 

Коммитим файл тогда, когда мы уверены, что все изменения, которые мы добавили в [[Staging area]], необходимо сохранить в базу Git. Они в сжатом виде помещаются в Каталог Git [[directory .git]].
#### Как Git определяет:
1. Фиксирует состояние файлов в **Tree-объекте** при коммите.
2. Связывает с **Commit-объектом** (хранит автор, дату, родительский коммит).

### Цикл жизни файла в Git
*Рисунок*
![[Pasted image 20250423144716.png]]

1. С помощью команды [[git add]] мы добавляем такой файл (_**Untracked)**_ в ***Индекс*** ([[Staging area]]). Из этой области так же можно удалить файл (См: )


***Untracked***    `>`    _**Staged**_

2. Если файл находится в состоянии _**Unmodified**_ (уже отслеживается гитом, но не измененный) и мы его изменяем — добавляем строчки, удаляем что-то, то Теперь он переходит в состояние "измененный отслеживаемый" (_**Modified**_):

_**Unmodified**_   `>`   _**Modified**_

В этом состоянии Git продолжает осуществлять контроль над всеми сделанными в этом файле изменениями, просто файл не будет добавлен в следующий коммит. 

Статус _**Modified**_ показывает, что файл имеет историю в системе Git и был изменен относительно его последнего состояния (то есть в [[Working directory]] мы изменили строки и теперь, так как он отслеживаемый, Git на видит изменения). 

Эти изменения так же можно убрать (См: [[Отмена изменений в Working Directory]]). 

3. Когда мы переносим наш уже измененный файл в промежуточную область:

_**Modified**_    `>`    **_Staged_**

Удалить любой файл из индекса можно! (См.: [[Удаление файлов из Индекса]])

4. Когда мы поместили файл в _**Индекс**_ и решили, что будем делать коммит этого файла
(который теперь находится в состоянии _**Staged)**_, то после выполнения коммита все изменения зафиксируются и больше изменений в данном файле в рабочей директории нет. 

Все изменения были перенесены в базу. Поэтому данный файл возвращается в свое изначальное состояние _—_ _**Unmodified**_ (не измененный отслеживаемый):

_**Staged**_    `>`   _**Unmodified**_

5. Мы всегда можем удалить любой файл, который отслеживается Гитом _— сделать его
неотслеживаемым (**Untracked**__):_

 ***Unmodified*** > ***Untracked***

Убрать файл из под отслеживания гита можно командой [[git rm]]. (См.: [[Удаление файлов из Индекса]])

