Git — это по сути **система управления ключ-значение**, где все данные хранятся как объекты в папке `.git/objects`. 

### Где хранятся объекты?
Все объекты находятся в `.git/objects/` в виде файлов с SHA-1-хэшами.
![[Pasted image 20250423180239.png]]

#### **Каждый объект:**
- Имеет **уникальный 40-символьный SHA-1-хэш** (первые 2 символа — подпапка)
- Хранится в **сжатом формате** (zlib)
- ***Неизменяем (при изменении создаётся новый объект)***

#### Типы объектов
1. Blob (Binary Large Object)
2. Tree (Дерево)
3. Commit (Коммит)
4. Tag (Аннотированный тег)

##### Blob

**Что хранит:** Содержимое **одного файла** (без имени, только данные).  
**Как создаётся:**

	 `echo "Hello" > file.txt
	 `git add file.txt  # Создаёт blob

##### Tree (Дерево)

**Что хранит:** Структуру **каталогов** (аналог папки). 

Дерево – это эквивалент директории. Блобы создаются для файлов, а деревья выходят на следующий уровень: они показывают связи между файлами. **_Для каждой папки_** репозитория во время коммита создается свой _**tree-объект**_.

_**Объект-дерево**_ содержит одну или более записей, указывающей на другое дерево или blob, группу других деревьев или блобов. Он показывает, какие файлы и папки лежат в каждой папке репозитория.

_**Объект-дерево**_ формируется для каждой папки репозитория во время коммита.

Содержит:

- Список файлов (blob) и поддиректорий (tree)
- Режимы доступа (100644 — файл, 100755 — исполняемый, 040000 — папка)
- Имена файлов/папок

**Пример содержимого:**

	 `100644 blob 8a9d638f...    file.txt
	 `040000 tree 1b2e3d4f...    src/

##### Commit (Коммит)

_**"объект коммита"**_  – это объект, который содержит информацию о текущем коммите. Он выполняет следующие задачи:

**Что хранит:**
- Ссылку на **tree** (состояние файлов)
- Родительские коммиты (parent)
- Автора, дату, сообщение

	 `tree 1b2e3d4f...
	 `parent a1b2c3d4...
	 `author John Doe <john@example.com> 1700000000 +0300
	 `committer John Doe <john@example.com> 1700000000 +0300
	 `Initial commit

_**Объект коммита**_ как и объект-дерево формируется во время коммита.
##### Tag (Аннотированный тег)

"_**тэг**_" (tag) — это способ маркировать определенный коммит как специфический, чтобы впоследствии было легче его найти. Маркировать — значит дать какое либо легко запоминающееся имя.

**Что хранит:**
- Ссылку на коммит
- Имя тега (v1.0)
- Подпись (если есть)

#### Когда создаются объекты?

1. При `git add`:
    - Создаётся **blob** из содержимого файла
    - Обновляется **index** (но tree/commit ещё нет)

2. При `git commit`:
    - Создаётся **tree** на основе index
    - Создаётся **commit**, ссылающийся на tree
    - Обновляется **HEAD**

#### Как просматривать файлы Git

Для просматривания объектов используется команда [[git cat-file]].

**Показать тип объекта можно так:**

	git cat-file -t <SHA-1 of object>

**Показать содержимое объекта:**

	 `git cat-file -p <SHA-1 of object>

**Найти все коммиты, где изменялся файл:**

#### Почему это важно?

1. **Невозможность потери данных**: Объекты неизменяемы — история нельзя "переписать", только добавить новые.
2. **Эффективность**: Хранение через хэши исключает дубликаты.
3. **Целостность**: Любое повреждение объекта приведёт к несовпадению хэшей.

**Пример безопасности:**  
Если изменить содержимое blob, его хэш изменится, и Git сразу обнаружит несоответствие.

